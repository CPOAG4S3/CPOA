CREATE OR REPLACE TRIGGER TR_BILLETS BEFORE UPDATE OF VENDU OR INSERT 
ON BILLETS 
FOR EACH ROW
IF INSERTING
THEN
	UPDATE TABLE ZONE SET DISPO = NEW.TOTAL, VENDU = 0 
		WHERE COURT = NEW.COURT 
		AND DATE = NEW.DATE 
		AND ZONE = NEW.ZONE;
ELIF UPDATING
THEN
	UPDATE TABLE ZONE SET DISPO = OLD.DISPO + (NEW.VENDU - OLD.VENDU)
		WHERE COURT = NEW.COURT
		AND DATE = NEW.DATE
		AND ZONE = NEW.ZONE;
END IF


-------

Version qui marche (update) :

DELIMITER $$

CREATE TRIGGER `TR_BILLETS_UPDATE` BEFORE UPDATE ON `BILLETS` 
FOR EACH ROW 
BEGIN 
	SET NEW.DISPO = OLD.DISPO + (NEW.VENDU - OLD.VENDU);
END
DELIMITER ;

----

Version qui marche (insert) :

DELIMITER $$

CREATE TRIGGER `TR_BILLETS_INSERT` BEFORE INSERT ON `BILLETS` 
FOR EACH ROW 
BEGIN 
	SET NEW.DISPO = NEW.TOTAL;
END$$

DELIMITER ;

----------

Note : Les triggers sous PHPMyAdmin, c'est pire que tout
